<!DOCTYPE html>
<html ng-app="myApp">
<head></head>
 <!-- Body tag augmented with ngController directive  -->
 <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.9/angular.min.js"></script>
 <style type="text/css">
 div.team{
	width:45%;
	display: inline-block;
	padding: 10px;
	height: 100%;
 }
 
 div.teamWrapper{
	width: 100%;
	margin: auto;
 }
 table{
	border: 1px solid black;
 }
 table td{
	border: 1px solid grey;
 }
 div.button{
 displa: block;
 }
 </style>
 <body>
	<h2>Select the teams that are going to do a trade, then select the players</h2>
	<form ng-controller="FTJController" class="teamWrapper" ng-submit="comparePlayers()">
		<div class="team" style="float: left;">
			{{list1}}
			<select ng-model="selectedTeam1" ng-options="item as item.teamName for item in teams track by item.teamID" ng-change="getRoster1(selectedTeam1)">
				<option value="">Team 1</option>
			</select>
			<table>
				<tr>
					<td></td>
					<td>Name</td>
					<td>Position</td>
					<td>NFLTeamName</td>
					<td>InjuryCode</td>
				</tr>
				<tr ng-repeat="player1 in roster1">
					<td><input type="radio" ng-value="{{player1.PlayerID}}" ng-model="selected1" ng-change="addID1(selected1)" name="selected1"/></td>
					<td>{{player1.Name}}</td>
					<td>{{player1.Position}}</td>
					<td>{{player1.NFLTeamName}}</td>
					<td>{{player1.InjuryCode}}</td>
				</tr>
			</table>
		</div>
		<div class="team">
			{{list2}}
			<select ng-model="selectedTeam2" ng-options="item as item.teamName for item in teams track by item.teamID" ng-change="getRoster2(selectedTeam2)">
				<option value="">Team 2</option>
			</select>
			<table>
				<tr>
					<td></td>
					<td>Name</td>
					<td>Position</td>
					<td>NFLTeamName</td>
					<td>InjuryCode</td>
				</tr>
				<tr ng-repeat="player2 in roster2" >
					<td><input type="radio" ng-value="{{player2.PlayerID}}" ng-model="selected2" ng-change="addID2(selected2)" name="selected2"/></td>
					<td>{{player2.Name}}</td>
					<td>{{player2.Position}}</td>
					<td>{{player2.NFLTeamName}}</td>
					<td>{{player2.InjuryCode}}</td>
				</tr>
			</table>
		</div>
		<br />
		<div class="button">
			<input type="submit" value="compare players" value="Submit"/>
			<div>Is this trade fair? {{FTJ}}</div>
		</div>
	</form>
	

   
   <script>
   //going to attempt select lists via @ng-app
	var myApp = angular.module('myApp',[]);
	myApp.controller('FTJController', function($scope, $http) {
		$scope.list1 = 'Select Team 1';
		$scope.list2 = 'Select Team 2';
		//$scope.selectedTeam = null;
		$scope.teams = [];
		$scope.players1 = [];
		$scope.players2 = [];
		$scope.roster1 = null;
		$scope.roster2 = null;
		$http({
            method: 'GET',
            url: 'http://localhost:8080/rest/LeagueTeams?LeagueID=1682132'
        }).success(function (result) {
        $scope.teams = result;
		});
		console.log("in controller");
		$scope.getRoster1 = function(selectedTeam){
			console.log("in getRoster with teamID = " + selectedTeam.teamID);
			$http({
				method: 'GET',
				url: 'http://localhost:8080/rest/Roster?LeagueID=1682132&TeamID=' +selectedTeam.teamID + '&Week=1&Year=2015'
			}).then(function (result){
				$scope.roster1 = result.data;
			});
			
		}
		
		//duplicating for now, should change to use the same method for both rosters
		$scope.getRoster2 = function(selectedTeam){
			console.log("in getRoster with teamID = " + selectedTeam.teamID);
			$http({
				method: 'GET',
				url: 'http://localhost:8080/rest/Roster?LeagueID=1682132&TeamID=' +selectedTeam.teamID + '&Week=1&Year=2015'
			}).then(function (result){
				$scope.roster2 = result.data;
			});
		}
		
		$scope.comparePlayers = function(){
			console.log("testingsss");
			console.log($scope.players1);
			console.log($scope.players2);
			console.log('call: http://localhost:8080/rest/FTJ?PlayerID1=' + $scope.players1 + '&PlayerID2=' + $scope.players1);
			console.log('Is $scope.players1 ' + ($scope.players1) + ' > $scope.players2 ' + $scope.players1 + ' ?');
			console.log('comparison');
			console.log($scope.players1 > $scope.players2);
			$http({
				method: 'GET',
				url: 'http://localhost:8080/rest/FTJ?PlayerID1=' + $scope.players1 + '&PlayerID2=' + $scope.players2
			}).then(function (result){
				console.log('result.data');
				console.log(result.data);
				if (result.data){
					$scope.FTJ = "Hell yea";
				} else {
					$scope.FTJ = "f no";
				}
			});
		};
		$scope.addID1 = function(s){
			$scope.players1 = s;
			console.log($scope.players1);

		};
		$scope.addID2 = function(s){
			$scope.players2 = s;
			console.log($scope.players2);
		};
	});
	
   </script>

 </body>

</html>
